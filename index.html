<!DOCTYPE html>
<html>
<head>
  <style>
    /* Estilos para el menú */
    .menu {
      text-align: center;
    }

    .menu button {
      margin: 10px;
      padding: 10px 20px;
      font-size: 18px;
    }

    /* Estilos para el tablero de juego */
    table {
      margin: 0 auto;
      border-collapse: collapse;
    }

    td {
      width: 30px;
      height: 30px;
      border: 1px solid black;
      text-align: center;
      font-size: 20px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="menu">
    <h1>Selecciona una dificultad</h1>
    <button onclick="crearTablero(9)">Principiante (9x9)</button>
    <button onclick="crearTablero(16)">Intermedio (16x16)</button>
    <button onclick="crearTablero(32)">Avanzado (32x32)</button>
  </div>

  <table id="board" style="display: none;"></table>

  <script>
    function crearTablero(tamaño) {
      // Oculta el menú y muestra el tablero
      document.querySelector('.menu').style.display = 'none';
      document.getElementById('board').style.display = 'table';

      // Obtén una referencia al elemento de la tabla
      var board = document.getElementById('board');

      // Genera el tablero del tamaño especificado
      var tablero = [];
      for (var i = 0; i < tamaño; i++) {
        var row = document.createElement('tr');
        var fila = [];
        for (var j = 0; j < tamaño; j++) {
          var cell = document.createElement('td');
          cell.onclick = function() {
            if (!juegoActivo) return;
            var row = this.parentNode.rowIndex;
            var col = this.cellIndex;
            if (tablero[row][col].isMine) {
              // Has hecho clic en una mina, fin del juego
              alert('Has perdido');
              juegoActivo = false;
            } else {
              // No es una mina, muestra el número de minas adyacentes
              this.textContent = tablero[row][col].count;
              this.classList.add('revealed');
              if (tablero[row][col].count === 0) {
                // Si el número de minas adyacentes es cero, revela las casillas adyacentes
                revelarCasillasAdyacentes(row, col);
              }
            }
          };
          fila.push({ element: cell, isMine: false, count: 0 });
          row.appendChild(cell);
        }
        tablero.push(fila);
        board.appendChild(row);
      }

      // Coloca minas aleatoriamente en el tablero
      var numMinas = Math.floor(tamaño * tamaño * 0.15); // Aproximadamente el 15% del total
      for (var k = 0; k < numMinas; k++) {
        var randomRow = Math.floor(Math.random() * tamaño);
        var randomCol = Math.floor(Math.random() * tamaño);
        if (!tablero[randomRow][randomCol].isMine) {
          tablero[randomRow][randomCol].isMine = true;
        } else {
          k--;
        }
      }

      // Calcula los números de minas adyacentes
      for (var m = 0; m < tamaño; m++) {
        for (var n = 0; n < tamaño; n++) {
          if (!tablero[m][n].isMine) {
            var count = 0;
            for (var p = Math.max(0, m - 1); p <= Math.min(m + 1, tamaño - 1); p++) {
              for (var q = Math.max(0, n - 1); q <= Math.min(n + 1, tamaño - 1); q++) {
                if (tablero[p][q].isMine) {
                  count++;
                }
              }
            }
            tablero[m][n].count = count;
          }
        }
      }

      var juegoActivo = true;

      function revelarCasillasAdyacentes(row, col) {
        for (var p = Math.max(0, row - 1); p <= Math.min(row + 1, tamaño - 1); p++) {
          for (var q = Math.max(0, col - 1); q <= Math.min(col + 1, tamaño - 1); q++) {
           var cell = tablero[p][q].element;
           if (!cell.classList.contains('revealed')) {
            cell.textContent = tablero[p][q].count;
            cell.classList.add('revealed');
            if (tablero[p][q].count === 0) {
            // Si el número de minas adyacentes es cero, revela las casillas adyacentes recursivamente
              revelarCasillasAdyacentes(p, q);
            }
          }
        }
      }
    }
  }
  </script>
</body>
</html>

